{% extends 'base.html' %}

{% block title %}Clim-Warn Early warning platform - UNEP{% endblock title %}
{% block extra_head %}
<link rel="stylesheet" href="http://openlayers.org/en/v3.0.0/css/ol.css" type="text/css">
<script src="{{ STATIC_URL }}js/jquery-1.11.2.min.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}js/bootstrap.min.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}js/ol.js"></script>
<script src="{{ STATIC_URL }}js/ol3-layerswitcher.js"></script>
<script src="{{ STATIC_URL }}js/layerswitcher.js"></script>
<script src="http://openlayers.org/en/v3.0.0/build/ol.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}national_map.js"></script>

<script type='text/javascript'>

    $(document).ready(function () {
        load_national_map();
        $('#tablist').tab();
    });

    var first_map, second_map, third_map 

    function init(){

    first_map = new ol.Map({
        target:'map',
        layers: [new ol.layer.Group({
            title: 'Base Maps',
            layers: [
            new ol.layer.Tile({
                title: 'OSM',
                visible: true,
                source: new ol.source.OSM()
                    })
                ]
            }),
            new ol.layer.Group({
                title: 'Overlays',
                layers:[ new ol.layer.Tile({
                    title: '- NDVI',
                    type: 'base',
                    source: new ol.source.TileWMS({
                        url: 'http://maps.virtualkenya.org/geoserver/wms',
                        params: {'LAYERS': 'geonode:ndvianom_2011_apr_dek1'},
                        serverType: 'geoserver' })
                    
                     }),
                new ol.layer.Tile({
                            title: '- Hazard',
                            type: 'base',
                            source: new ol.source.TileWMS({
                            url: 'http://maps.virtualkenya.org/geoserver/wms',
                            params: {'LAYERS': 'geonode:spi_201103_dek1 '},
                            serverType: 'geoserver' })
                            
                            }),
                    new ol.layer.Tile({
                            title: '- Anom',
                            type: 'base',
                            source: new ol.source.TileWMS({
                            url: 'http://maps.virtualkenya.org/geoserver/wms',
                            params: {'LAYERS': 'geonode:spi_201103_dek1 '},
                            serverType: 'geoserver' })
                            
                        }),
                    new ol.layer.Tile({
                            title: '- Aver',
                            type: 'base',
                            source: new ol.source.TileWMS({
                            url: 'http://maps.virtualkenya.org/geoserver/wms',
                            params: {'LAYERS': 'geonode:spi_201103_dek1 '},
                            serverType: 'geoserver' })
                            
                        }),
                    new ol.layer.Tile({
                            title: '- Ita',
                            type: 'base',
                            source: new ol.source.TileWMS({
                            url: 'http://maps.virtualkenya.org/geoserver/wms',
                            params: {'LAYERS': 'geonode:spi_201103_dek1 '},
                            serverType: 'geoserver' })
                            
                        }),
                    new ol.layer.Tile({
                            title: '- Spi',
                            type: 'base',
                            source: new ol.source.TileWMS({
                            url: 'http://maps.virtualkenya.org/geoserver/wms',
                            params: {'LAYERS': 'geonode:spi_201103_dek1 '},
                            serverType: 'geoserver' })
                            
                        })
                ]
            })
        ],
        view: new ol.View({
            projection: 'EPSG:900913',
            center:[3930427, 359171],
            zoom:6
            })
    });
    
    second_map = new ol.Map({
        target:'map_2',
        layers: [new ol.layer.Group({
            title: 'Base Maps',
            layers: [
            new ol.layer.Tile({
                title: 'OSM',
                type: 'base',
                visible: true,
                source: new ol.source.OSM()
                    })
                ]
            }),
            new ol.layer.Group({
                title: 'Overlays',
                layers:[ new ol.layer.Tile({
                    title: 'Drought Turkana',
                    source: new ol.source.TileWMS({
                        url: 'http://maps.virtualkenya.org/geoserver/wms',
                        params: {'LAYERS': 'geonode:vulnerability_classified'},
                        serverType: 'geoserver' 
                            })
                     })
                ]
            })
        ]
    });
    
    third_map = new ol.Map({
        target:'map_3',
        layers: [new ol.layer.Group({
            title: 'Base Maps',
            layers: [
            new ol.layer.Tile({
                title: 'OSM',
                type: 'base',
                visible: true,
                source: new ol.source.OSM()
                    })
                ]
            }),
            new ol.layer.Group({
                title: 'Overlays',
                layers:[ new ol.layer.Tile({
                    title: 'Drought risk map',
                    source: new ol.source.TileWMS({
                        url: 'http://maps.virtualkenya.org/geoserver/wms',
                        params: {'LAYERS': 'geonode:dr_03_dek3'},
                        serverType: 'geoserver' 
                            })
                     })
                ]
            })
        ]
    });
    four_map = new ol.Map({
        target:'map_4',
        layers: [new ol.layer.Group({
            title: 'Base Maps',
            layers: [
            new ol.layer.Tile({
                title: 'OSM',
                type: 'base',
                visible: true,
                source: new ol.source.OSM()
                    })
                ]
            }),
            new ol.layer.Group({
                title: 'Overlays',
                layers:[ new ol.layer.Tile({
                    title: 'Drought Turkana',
                    source: new ol.source.TileWMS({
                        url: 'http://maps.virtualkenya.org/geoserver/wms',
                        params: {'LAYERS': 'geonode:drought_constituencies'},
                        serverType: 'geoserver' 
                            })
                     })
                ]
            })
        ]
    });
    second_map.bindTo('view', first_map);
    third_map.bindTo('view', first_map);
    four_map.bindTo('view', first_map);
    

    var layerSwitcher = new ol.control.LayerSwitcher();
    first_map.addControl(layerSwitcher);
    //national_map.addControl(layerSwitcher);
    
}
</script>
<style>
    .vcenter {
        display: inline-block;
        vertical-align: middle;
        float: none;
    }
    
.column{
float:left;
width:550px;
height:300px;
padding:20px;
overflow-y:hidden;

}
.ol_legend {
    bottom: 0px; left: 0px; position: absolute; background-color: #FFFFFF;
    }
</style>
{% endblock extra_head %}

{% block main_content %}
 <div class="container-fluid">
 	<div class="row">
 		<div class="col-xs-4 vcenter">
 			<h3>Drought Early Warning Platform</h3>
 		</div>
 		<div class="col-xs-4 vcenter">&nbsp;
 		</div>
 		<div class="col-xs-4 vcenter">
 		</div>
 	</div>
 	<div class="row">
 		<div role="tabpanel">
 			<ul class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active"><a href="#national" aria-controls="national" role="tab" data-toggle="tab">National</a></li>
 				<li role="presentation"><a href="#datespecific" aria-controls="datespecific" role="tab" data-toggle="tab">Turkana 2011</a></li>
 				<li role="presentation"><a href="#animation" aria-controls="animation" role="tab" data-toggle="tab">2011 Animation</a></li>
 			</ul>
            
 			<div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="national">
                    <div class="row">
                        <div class="col-md-9">
                            <h4 align="center">National</h4>
                            <div id="nat_map"></div>
                        </div>
                    </div>
                </div>
        
 				<div role="tabpanel" class="tab-pane" id="datespecific">
                    <div class="row">
                        <div class="col-md-5">
                            <h4>Hazard</h4>
                            <div id="map"></div>
                            <div class="pull-right">
                            <img src = "http://maps.virtualkenya.org/geoserver/wms?REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&WIDTH=5&HEIGHT=5&LAYER=geonode:turkana_spi_2014_ond&legend_options=fontName:Times%20New%20Roman;fontAntiAliasing:true;fontColor:0x000033;fontSize:4;bgColor:0xFFFFEE;dpi:180"/>
                            </div>
                        </div>
                        <div class="col-md-5">
                            <h4>Vulnerability</h4>
                            <div id="map_2"></div> 
                            <div class="pull-right">
                                <img src = "http://maps.virtualkenya.org/geoserver/wms?REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&WIDTH=10&HEIGHT=10&LAYER=geonode:vulnerability_classified&legend_options=fontName:Times%20New%20Roman;fontAntiAliasing:true;fontSize:12;"/>
                            </div>                           
                        </div>
                        <div class="col-md-2">
                            <div>&nbsp;</div>
                            <form method="POST">{% csrf_token %}
                                <input type="hidden" name="alert_type" value="SMS">
                                <input type="hidden" name="hazard_type" value="Drought">
                                <button type="submit" class="btn btn-md btn-block btn-default">
                                    Send SMS
                                </button>
                            </form>
                            <div>&nbsp;</div>
                            <form method="POST">{% csrf_token %}
                                <input type="hidden" name="alert_type" value="EMAIL">
                                <input type="hidden" name="hazard_type" value="Drought">
                                <button type="submit" class="btn btn-md btn-block btn-default">
                                    Send Email
                                </button>
                            </form>
                            <div>&nbsp;</div>
                            <a href="/flood">Go to flood</a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-5">
                            <h4>Risk</h4>
                            <div id="map_3"></div>
                            <div class="pull-right">
                                <img src="http://maps.virtualkenya.org/geoserver/wms?REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&WIDTH=10&HEIGHT=10&LAYER=geonode:dr_03_dek3&legend_options=fontName:Times%20New%20Roman;fontAntiAliasing:true;fontColor:0x000033;fontSize:7;bgColor:0xFFFFEE;dpi:180"/>
                            </div>
                        </div>
                        <div class="col-md-5">
                            <h4>User</h4>
                            <div id="map_4"></div>
                        </div>
                    </div>
 				</div>
 				<div role="tabpanel" class="tab-pane" id="animation">
 					<img src='http://maps.virtualkenya.org/geoserver/Drought_Kenya/wms/animate?service=WMS&version=1.1.0&request=GetMap&layers=Drought_Kenya:Drought_Kenya_1&styles=&bbox=33.90673828125,-4.6533203125,41.81689453125,5.4541015625&width=400&height=512&srs=EPSG:4326&format=image/gif;subtype=animated&format_options=layout:drought_kenya_msg;gif_loop_continuosly:true&time=2015-01-03,%202015-02-03,%202015-03-03,%202015-04-03,%202015-05-03,%20%202015-06-03,%202015-07-03,%202015-08-03,%202015-09-03,%202015-10-03,%202015-11-03,%202015-12-03,%202015-13-03,%202015-14-03,%202015-15-03,%202015-16-03,%202015-17-03,%202015-18-03,%202015-19-03,%202015-20-03,%202015-21-03,%202015-22-03,%202015-23-03,%202015-24-03,%202015-25-03,%202015-26-03,%202015-27-03,%202015-28-03,%202015-29-03,%202015-30-03,%202015-31-03,%202015-01-04'/>
 				</div>
 			</div> 			
 		</div>
 	</div>
 </div>

{% endblock main_content %}
